# Modification of gen-keybinding-img

<img src="../keybind-map/mod4.png" width="35%">&nbsp;<img src="../keybind-map/mod4-z.png" width="35%">


## 概要

KeyChordを含むキーバインドを設定していると、`gen-keybinding-img`が異常終了すると思います。私は、これを回避するため、最低限の改修を行いました。ただし、下記の制限があります。

- 2ストローク以上のキーバインドには対応していません（おそらく、未確認）
- 2ストローク目に、複数のキーのコンビネーションが割り当てられていてもアルファベットキーしか認識しません  
具体的には、Super+zでKeyChordが開始され、aを押下してあるアプリケーションが起動というパターンは対応できます。しかし、Super+z、次いで、Shift+aの場合、aは認識できますが、Shiftの部分が認識できていません
- この改修に関して、私は`yay`でQtileを導入しているため、Qtile開発チームへのプルリクエストなどのアクションを起こせません

一方で、せっかくなので、下記の改修を行っています。

- 画面サイズを1920x1080に拡張
- フォント設定の修正（ザイズ・色）


## `gen-keybinding-img`を動かすための準備

繰り返しになりますが、私は`yay`でQtileを導入しています。このため、普通は`gen-keybinding-img`が起動しません。この状態を回避するため、下記の対応を行っています。

- `/usr/bin/qtile`を`~/.config/qtile/bin/`にシンボリックリンク
- `~/.config/qtile/`に`logo.png`をダウンロード
- `~/.config/qtile/keybind-map/`ディレクトリの作成（画像イメージが格納される）
- `gen-keybinding-img`の入手と、`~/.config/qtile/scripts/`への格納

なお、実際の起動は、`~/.config/qtile/scripts/gen-keybinding-img.sh`で行っています。


## 私見

私個人としては、キーバインドをリスト形式の文字列ではなく、画像で表示できるツールの存在が非常にありがたいと感じています。直感でキーバインドを認識できますので。ところが、他のタイル型ウィンドウマネージャには、おそらく、この機能が存在しない模様です。
可能ならば、いわゆる「プログラム分割」という形式で、下記の対応を行いたいです。（時間と余力があれば）

1. キーバインドの解析を行い、設定を統一した出力項目のJSONで保存
2. そのJSONを読み込み、キーボードの画像に表示

なお、「キーボード」と一言で言っても、キーボード配置が千差万別なのは承知しています。そこは一旦置いて。実は私も、記号に関しては、このキーボード配列ではありません。最低限、特殊キー・数字・アルファベットが同じという状態ですが、それでも便利なPythonスクリプト（実態はCairoが動いている）には違いないと感じています。


